name: Ping Render & Azure Email Job

on:
  schedule:
    - cron: "*/5 * * * *"  # ch·∫°y m·ªói 5 ph√∫t
  workflow_dispatch:         # c√≥ th·ªÉ ch·∫°y th·ªß c√¥ng n·∫øu mu·ªën

jobs:
  ping:
    runs-on: ubuntu-latest

    steps:
      - name: Wake up Render app
        run: |
          echo "üü° Waking up Render app..."
          curl -s -L https://podcast-shoppings.onrender.com > /dev/null || echo "‚ö†Ô∏è Render app may be sleeping"

      - name: Wait for Render to wake up
        run: |
          echo "‚è≥ Waiting for Render app to stabilize..."
          sleep 20

      - name: Trigger Azure email job
        run: |
          echo "üìß Triggering scheduled email job..."
          curl -s -L https://healink-ewaybqg9encadbe8.southeastasia-01.azurewebsites.net/api/emails/run-email-job \
          -o /dev/null -w "%{http_code}\n"
